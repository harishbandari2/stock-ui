<div class="page-header">
  <!-- <div class="page-header-content header-elements-md-inline">
      <div class="page-title d-flex">
        <h4><span class="font-weight-semibold">Flow</span> - Pipes</h4>
        <a class="header-elements-toggle text-default d-md-none"><i class="icon-more"></i></a>
      </div>
      <div class="header-elements d-none">
        <div class="d-flex justify-content-center">
          <a routerLink="/apps" class="btn btn-link btn-float text-default"
            ><i class="icon-meter-fast text-primary"></i> <span>Dashboard</span></a
          >
          <a class="btn btn-link btn-float text-default"
            ><i class="icon-stats-dots text-primary"></i><span>Monitor</span></a
          >
  
          <a routerLink="/flows" class="btn btn-link btn-float text-default"
            ><i class="icon-cogs text-primary"></i> <span>Flows</span></a
          >
        </div>
      </div>
    </div> -->

  <div class="breadcrumb-line breadcrumb-line-light header-elements-md-inline">
    <div class="d-flex">
      <div class="breadcrumb">
        <!-- <a href="index.html" class="breadcrumb-item"><i class="icon-home2 mr-2"></i> Home</a>
          <a href="widgets_content.html" class="breadcrumb-item">Widgets</a> -->
        <span class="breadcrumb-item active">Portfolios</span>
      </div>

      <a class="header-elements-toggle text-default d-md-none">
        <button
          type="button"
          (click)="openModel(content)"
          class="btn btn-outline btn-sm alpha-success text-success-800 border-success-600"
        >
          <i class="icon-plus2 mr-2"></i> Create
        </button>
      </a>
    </div>

    <div class="header-elements d-none">
      <div class="breadcrumb justify-content-center">
        <a class="breadcrumb-elements-item">
          <!-- <button type="button" class="btn btn-outline bg-primary text-primary border-primary">
                            <i class="icon-plus2 mr-2"></i>
                            Create Flow
                        </button> -->
          <button
            type="button"
            (click)="openModel(content)"
            class="btn btn-outline btn-sm alpha-success text-success-800 border-success-600"
          >
            <i class="icon-plus2 mr-2"></i> Create
          </button>
        </a>
      </div>
    </div>
  </div>
</div>

<div class="content">
  <!-- Inner container -->
  <div class="d-flex align-items-start flex-column flex-md-row">
    <!-- Left content -->
    <div class="w-100 order-2 order-md-1">
      <!-- Task grid -->
      <div class="row">
        <div class="col-xl-3" *ngFor="let item of basketList; let index = index">
          <div class="card  rounded-left-0">
            <div class="card-body">
              <div class="d-sm-flex align-item-sm-center flex-sm-nowrap">
                <div>
                  <h6 class="font-weight-semibold mb-0 pointer" routerLink="/strategy/{{ item._id }}">
                    {{ item.name | titlecase }}
                  </h6>
                  <p class="mb-3 text-muted">{{ item.description }}</p>

                  <a>
                    <i class="icon-trophy3 mr-2  text-success-800"></i>
                    Win: {{ item.winrate | number: '1.2-2' }}%
                  </a>
                  <!-- <a>
                        <img
                          src="assets/images/logo/trello.svg"
                          class="bg-transparent border-slate-300 text-slate rounded-round border "
                          width="36"
                          height="36"
                          alt=""
                        />
                      </a>
                      <a>
                        <img
                          src="assets/images/logo/freshdesk.svg"
                          class="bg-transparent border-slate-300 text-slate rounded-round border"
                          width="36"
                          height="36"
                          alt=""
                        />
                      </a>
                      <a class="btn btn-icon bg-transparent border-slate-300 text-slate rounded-round border-dashed"
                        ><i class="icon-plus22"></i
                      ></a> -->
                </div>

                <ul class="list list-unstyled mb-0 mt-3 mt-sm-0 ml-auto">
                  <li>
                    Since:
                    <span class="text-muted">{{ item.createdAt | date }}</span>
                  </li>
                  <li>
                    Status: &nbsp;
                    <a
                      *ngIf="item.status == 'Deployed'"
                      class="badge badge-flat bg-success border-success  text-white-600 rounded-0 dropdown-toggle"
                      >{{ item.status }}</a
                    >
                    <a
                      *ngIf="item.status == 'Paper' || !item.status"
                      class="badge badge-secondary border-secondary text-secondary rounded-0 dropdown-toggle"
                      >Paper</a
                    >
                  </li>
                </ul>
              </div>
            </div>

            <div class="card-footer d-sm-flex justify-content-sm-between align-items-sm-center">
              <span
                >Returns:
                <span class="font-weight-semibold" [class]="item.returns > 0 ? 'text-success' : 'text-danger'"
                  >{{ item.returns | number: '1.2-2' }}%</span
                ></span
              >

              <ul class="list-inline mb-0 mt-2 mt-sm-0 pointer">
                <!-- <li class="list-inline-item pointer" (click)="deleteFlow(index)"><i class="icon-trash"></i></li> -->
                <li class="list-inline-item dropdown" ngbDropdown>
                  <a class="text-default dropdown-toggle" data-toggle="dropdown" ngbDropdownToggle
                    ><i class="icon-menu7"></i
                  ></a>

                  <div class="dropdown-menu dropdown-menu-right" ngbDropdownMenu>
                    <a class="dropdown-item" (click)="suspendFlow(item, item.status)"
                      ><i class="icon-alarm-add"></i>{{ item.status == 'ENABLED' ? 'Disable' : 'Enable' }}</a
                    >
                    <!-- <a class="dropdown-item"><i class="icon-attachment"></i> Attach screenshot</a> -->
                    <!-- <a class="dropdown-item"><i class="icon-rotate-ccw2"></i> Reassign</a> -->
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" (click)="editBasket(content, item)"><i class="icon-pencil7"></i> Edit</a>
                    <a class="dropdown-item" (click)="deleteBasket(item)"><i class="icon-cross2"></i>Delete</a>
                  </div>
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>

      <!-- /task grid -->

      <!-- Pagination -->

      <!-- /pagination -->
    </div>
    <!-- /left content -->

    <!-- Right sidebar component -->

    <!-- /right sidebar component -->
  </div>
  <!-- /inner container -->
</div>

<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">Create New</h4>
    <button type="button" class="close" aria-label="Close" (click)="modal.dismiss('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="ml-2 row">
      <div class="customcard" *ngFor="let card of createNew" style="cursor:not-allowed">
        <span
          (click)="activeCard(card)"
          [ngClass]="{ activeCard: card.name == activeNode?.name, enabled: card.enabled }"
          style="pointer-events: none;"
        >
          <i class="{{ card.icon }} icon-2x text-white customIcon"></i>
          <div class="cText text-white mb-0">{{ card.name }}</div>
        </span>
      </div>
    </div>
    <div class="row mb-2">
      <div class="col-xl-12">
        <p class="card-footer mt-2">
          {{ activeNode.description }}
        </p>
      </div>
    </div>
    <form [formGroup]="flowForm">
      <ng-container *ngIf="activeNode.name !== 'Strategy'">
        <div class="row ">
          <div class="col-xl-6">
            <div class="form-group">
              <label for="dateOfBirth">Name</label>
              <div class="input-group">
                <input id="dateOfBirth" formControlName="name" class="form-control" placeholder="Portfolio Name" />
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-xl-6">
            <div class="form-group">
              <label for="dateOfBirth">Description</label>
              <div class="input-group">
                <input id="margin" type="text" formControlName="description" class="form-control" placeholder="notes" />
              </div>
            </div>
          </div>
          <div class="col-xl-6">
            <div class="form-group">
              <label for="dateOfBirth">Margin</label>
              <div class="input-group">
                <input type="number" formControlName="margin" class="form-control" placeholder="Portfolio Margin" />
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </form>
    <div class="row">
      <div class="col-xl-12">
        <div class="form-group">
          <label for="dateOfBirth">Algos</label>
          <ng-multiselect-dropdown
            [placeholder]="'Select Algos'"
            [settings]="dropdownSettings"
            [data]="algoList"
            [(ngModel)]="selectedAlgos"
          >
          </ng-multiselect-dropdown>
        </div>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button *ngIf="!pId" type="button" class="btn bg-primary-800" (click)="save(flowForm.value)">Save</button>
    <button *ngIf="pId" type="button" class="btn bg-primary-800" (click)="update(flowForm.value, pId)">Update</button>
  </div>
</ng-template>
